{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "data-grid-select-column",
  "title": "Data Grid Select Column",
  "description": "A reusable select column definition for the data grid with checkbox selection and shift-click support",
  "dependencies": [
    "@tanstack/react-table"
  ],
  "registryDependencies": [
    "checkbox"
  ],
  "files": [
    {
      "path": "src/components/data-grid/data-grid-select-column.tsx",
      "content": "\"use client\";\n\nimport type {\n  CellContext,\n  ColumnDef,\n  HeaderContext,\n} from \"@tanstack/react-table\";\nimport * as React from \"react\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { cn } from \"@/lib/utils\";\n\ninterface DataGridSelectHitboxProps {\n  htmlFor: string;\n  debug?: boolean;\n  children: React.ReactNode;\n}\n\nfunction DataGridSelectHitbox({\n  htmlFor,\n  debug,\n  children,\n}: DataGridSelectHitboxProps) {\n  return (\n    <div className=\"group relative -mx-3 -my-1.5 h-[calc(100%+0.75rem)] px-3 py-1.5\">\n      {children}\n      <label\n        htmlFor={htmlFor}\n        className={cn(\n          \"absolute inset-0 cursor-pointer\",\n          debug && \"border border-red-500 border-dashed bg-red-500/20\",\n        )}\n      />\n    </div>\n  );\n}\n\ninterface DataGridSelectCheckboxProps\n  extends Omit<React.ComponentProps<typeof Checkbox>, \"id\"> {\n  rowNumber?: number;\n  debug?: boolean;\n}\n\nfunction DataGridSelectCheckbox({\n  rowNumber,\n  checked,\n  className,\n  debug,\n  ...props\n}: DataGridSelectCheckboxProps) {\n  const id = React.useId();\n\n  if (rowNumber !== undefined) {\n    return (\n      <DataGridSelectHitbox htmlFor={id} debug={debug}>\n        <div\n          aria-hidden=\"true\"\n          data-state={checked ? \"checked\" : \"unchecked\"}\n          className=\"pointer-events-none absolute start-3 top-1.5 flex size-4 items-center justify-center text-muted-foreground text-xs tabular-nums transition-opacity group-hover:opacity-0 data-[state=checked]:opacity-0\"\n        >\n          {rowNumber}\n        </div>\n        <Checkbox\n          id={id}\n          className={cn(\n            \"relative transition-[shadow,border,opacity] hover:border-primary/40\",\n            \"opacity-0 group-hover:opacity-100 data-[state=checked]:opacity-100\",\n            className,\n          )}\n          checked={checked}\n          {...props}\n        />\n      </DataGridSelectHitbox>\n    );\n  }\n\n  return (\n    <DataGridSelectHitbox htmlFor={id} debug={debug}>\n      <Checkbox\n        id={id}\n        className={cn(\n          \"relative transition-[shadow,border] hover:border-primary/40\",\n          className,\n        )}\n        checked={checked}\n        {...props}\n      />\n    </DataGridSelectHitbox>\n  );\n}\n\ninterface DataGridSelectHeaderProps<TData>\n  extends Pick<HeaderContext<TData, unknown>, \"table\"> {\n  debug?: boolean;\n}\n\nfunction DataGridSelectHeader<TData>({\n  table,\n  debug,\n}: DataGridSelectHeaderProps<TData>) {\n  const onCheckedChange = React.useCallback(\n    (value: boolean) => table.toggleAllPageRowsSelected(value),\n    [table],\n  );\n\n  return (\n    <DataGridSelectCheckbox\n      aria-label=\"Select all\"\n      checked={\n        table.getIsAllPageRowsSelected() ||\n        (table.getIsSomePageRowsSelected() && \"indeterminate\")\n      }\n      onCheckedChange={onCheckedChange}\n      debug={debug}\n    />\n  );\n}\n\ninterface DataGridSelectCellProps<TData>\n  extends Pick<CellContext<TData, unknown>, \"row\" | \"table\"> {\n  enableRowMarkers?: boolean;\n  debug?: boolean;\n}\n\nfunction DataGridSelectCell<TData>({\n  row,\n  table,\n  enableRowMarkers,\n  debug,\n}: DataGridSelectCellProps<TData>) {\n  const meta = table.options.meta;\n  const rowNumber = enableRowMarkers\n    ? (meta?.getVisualRowIndex?.(row.id) ?? row.index + 1)\n    : undefined;\n\n  const onCheckedChange = React.useCallback(\n    (value: boolean) => {\n      if (meta?.onRowSelect) {\n        meta.onRowSelect(row.index, value, false);\n      } else {\n        row.toggleSelected(value);\n      }\n    },\n    [meta, row],\n  );\n\n  const onClick = React.useCallback(\n    (event: React.MouseEvent<HTMLButtonElement>) => {\n      if (event.shiftKey) {\n        event.preventDefault();\n        meta?.onRowSelect?.(row.index, !row.getIsSelected(), true);\n      }\n    },\n    [meta, row],\n  );\n\n  return (\n    <DataGridSelectCheckbox\n      aria-label={rowNumber ? `Select row ${rowNumber}` : \"Select row\"}\n      checked={row.getIsSelected()}\n      onCheckedChange={onCheckedChange}\n      onClick={onClick}\n      rowNumber={rowNumber}\n      debug={debug}\n    />\n  );\n}\n\ninterface GetDataGridSelectColumnOptions<TData>\n  extends Omit<Partial<ColumnDef<TData>>, \"id\" | \"header\" | \"cell\"> {\n  enableRowMarkers?: boolean;\n  debug?: boolean;\n}\n\nexport function getDataGridSelectColumn<TData>({\n  size = 40,\n  enableHiding = false,\n  enableResizing = false,\n  enableSorting = false,\n  enableRowMarkers = false,\n  debug = false,\n  ...props\n}: GetDataGridSelectColumnOptions<TData> = {}): ColumnDef<TData> {\n  return {\n    id: \"select\",\n    header: ({ table }) => <DataGridSelectHeader table={table} debug={debug} />,\n    cell: ({ row, table }) => (\n      <DataGridSelectCell\n        row={row}\n        table={table}\n        enableRowMarkers={enableRowMarkers}\n        debug={debug}\n      />\n    ),\n    size,\n    enableHiding,\n    enableResizing,\n    enableSorting,\n    ...props,\n  };\n}\n",
      "type": "registry:component",
      "target": "src/components/data-grid/data-grid-select-column.tsx"
    }
  ],
  "type": "registry:component"
}